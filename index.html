<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Fun with Words</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
      body {
        background-color: #121212;
        color: #fff;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
      }
      .flashcard-box {
        border: 2px solid #007bff;
        border-radius: 12px;
        padding: 40px 20px;
        background-color: #1e1e1e;
        width: 320px;
        text-align: center;
      }
      .english-word {
        font-size: 24px;
        margin-bottom: 20px;
        font-weight: bold;
        cursor: pointer;
        color: #007bff;
      }
      .separator {
        height: 1px;
        background-color: #007bff;
        margin: 15px auto;
        width: 80%;
      }
      .portuguese-button {
        border: 1px solid #007bff;
        border-radius: 12px;
        background-color: transparent;
        font-size: 24px;
        font-weight: bold;
        margin-top: 20px;
        width: 80%;
        height: 50px;
        line-height: 50px;
        color: #007bff;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
        white-space: nowrap;
      }
      .portuguese-button.revealed {
        background-color: #007bff;
        color: #fff;
      }
      .controls {
        margin-top: 20px;
        display: flex;
        gap: 10px;
      }
      button.control-button {
        background-color: #007bff;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 18px;
      }
      button.control-button:hover {
        background-color: #0056b3;
      }
      h1 {
        font-size: 2rem;
        margin-bottom: 30px;
      }
    </style>
  </head>
  <body>
    <h1>üá∫üá∏ Fun with Words üáßüá∑</h1>
    <div class="flashcard-box">
      <div id="english-word" class="english-word">Loading...</div>
      <div class="separator"></div>
      <button id="portuguese-button" class="portuguese-button">&nbsp;</button>
    </div>
    <div class="controls">
      <button id="prev" class="control-button">‚¨ÖÔ∏è</button>
      <button id="shuffle" class="control-button">üîÄ</button>
      <button id="speak" class="control-button">üîä</button>
      <button id="next" class="control-button">‚û°Ô∏è</button>
    </div>

    <script>
      const SHEET_ID = '1Jb_MbdGdlb24dzBwGERLu4ro8yG7iRmt9iki01aUuPo';
      const API_KEY = 'AIzaSyBI854qdvpwzufU54QF4GPmyt5ded7TA4Q';
      const RANGE = 'Sheet1!A:B';

      let flashcards = [];
      let currentIndex = 0;

      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      function loadClient() {
        gapi.client.init({ apiKey: API_KEY }).then(() => {
          return gapi.client.request({
            path: `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}`,
          });
        }).then(
          (response) => {
            flashcards = response.result.values.slice(1);
            shuffleArray(flashcards);
            showFlashcard();
          },
          (error) => {
            console.error(error);
            document.getElementById('english-word').innerText = 'Error loading flashcards.';
          }
        );
      }

      function showFlashcard() {
        if (flashcards.length === 0) return;
        const [question, answer] = flashcards[currentIndex];

        const englishWord = document.getElementById('english-word');
        const portugueseButton = document.getElementById('portuguese-button');

        englishWord.innerText = question;
        portugueseButton.classList.remove('revealed');
        portugueseButton.innerHTML = "&nbsp;";
      }

      document.getElementById('portuguese-button').addEventListener('click', () => {
        const portugueseButton = document.getElementById('portuguese-button');
        portugueseButton.innerText = flashcards[currentIndex][1];
        portugueseButton.classList.add('revealed');
      });

      document.getElementById('english-word').addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % flashcards.length;
        showFlashcard();
      });

      document.getElementById('next').addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % flashcards.length;
        showFlashcard();
      });

      document.getElementById('prev').addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + flashcards.length) % flashcards.length;
        showFlashcard();
      });

      document.getElementById('shuffle').addEventListener('click', () => {
        shuffleArray(flashcards);
        currentIndex = 0;
        showFlashcard();
      });

      document.getElementById('speak').addEventListener('click', () => {
        const utterance = new SpeechSynthesisUtterance(flashcards[currentIndex][0]);
        const voices = speechSynthesis.getVoices();
        const female = voices.find(v =>
          v.name.toLowerCase().includes('female') ||
          v.name.toLowerCase().includes('samantha') ||
          v.name.toLowerCase().includes('karen')
        );
        if (female) utterance.voice = female;
        utterance.lang = 'en-US';
        speechSynthesis.speak(utterance);
      });

      gapi.load('client', loadClient);
    </script>
  </body>
</html>
