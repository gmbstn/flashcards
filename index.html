<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Fun with Words</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
      body {
        background-color: #121212;
        color: #fff;
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
      .flashcard-box {
        border: 2px solid #007bff;
        border-radius: 12px;
        padding: 40px 20px;
        margin: 40px auto;
        background-color: #1e1e1e;
        width: 320px;
      }
      .english-word {
        font-size: 24px;
        margin-bottom: 10px;
        font-weight: bold;
        cursor: pointer;
        color: #007bff;
      }
      .separator {
        height: 1px;
        background-color: #007bff;
        margin: 15px auto;
        width: 80%;
      }
      .portuguese-card {
        background-color: #121212;
        border: 1px solid #007bff;
        border-radius: 12px;
        color: #007bff;
        padding: 10px 20px;
        font-size: 24px;
        visibility: hidden;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        width: 80%;
        margin: 0 auto;
      }
      .portuguese-card.visible {
        visibility: visible;
        opacity: 1;
      }
      button {
        background-color: #007bff;
        color: #fff;
        border: none;
        margin: 10px;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 18px;
      }
      button:hover {
        background-color: #0056b3;
      }
      .controls {
        margin-top: 40px;
      }
      h1 {
        font-size: 2rem;
        margin-bottom: 40px;
      }
    </style>
  </head>
  <body>
    <h1>üá∫üá∏ Fun with Words üáßüá∑</h1>
    <div class="flashcard-box">
      <div id="english-word" class="english-word">Loading...</div>
      <div class="separator"></div>
      <div id="portuguese-card" class="portuguese-card">Portuguese</div>
    </div>
    <div class="controls">
      <button id="prev">‚¨ÖÔ∏è</button>
      <button id="shuffle">üîÄ</button>
      <button id="speak">üîä</button>
      <button id="next">‚û°Ô∏è</button>
    </div>

    <script>
      const SHEET_ID = '1Jb_MbdGdlb24dzBwGERLu4ro8yG7iRmt9iki01aUuPo';
      const API_KEY = 'AIzaSyBI854qdvpwzufU54QF4GPmyt5ded7TA4Q';
      const RANGE = 'Sheet1!A:B';

      let flashcards = [];
      let currentIndex = 0;

      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      function loadClient() {
        gapi.client.init({ apiKey: API_KEY }).then(() => {
          return gapi.client.request({
            path: `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}`,
          });
        }).then(
          (response) => {
            flashcards = response.result.values.slice(1);
            shuffleArray(flashcards);
            showFlashcard();
          },
          (error) => {
            console.error(error);
            document.getElementById('english-word').innerText = 'Error loading flashcards.';
          }
        );
      }

      function showFlashcard() {
        if (flashcards.length === 0) return;
        const [question, answer] = flashcards[currentIndex];

        const englishWord = document.getElementById('english-word');
        const portugueseCard = document.getElementById('portuguese-card');

        englishWord.innerText = question;

        portugueseCard.innerText = answer;
        portugueseCard.classList.remove('visible');
        portugueseCard.style.visibility = 'hidden';
        portugueseCard.style.opacity = '0';
      }

      document.getElementById('portuguese-card').addEventListener('click', () => {
        const portugueseCard = document.getElementById('portuguese-card');
        portugueseCard.classList.add('visible');
      });

      document.getElementById('english-word').addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % flashcards.length;
        showFlashcard();
      });

      document.getElementById('next').addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % flashcards.length;
        showFlashcard();
      });

      document.getElementById('prev').addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + flashcards.length) % flashcards.length;
        showFlashcard();
      });

      document.getElementById('shuffle').addEventListener('click', () => {
        shuffleArray(flashcards);
        currentIndex = 0;
        showFlashcard();
      });

      document.getElementById('speak').addEventListener('click', () => {
        const utterance = new SpeechSynthesisUtterance(
          flashcards[currentIndex][0]
        );
        // Try to select a female voice
        const voices = speechSynthesis.getVoices();
        const female = voices.find(v => v.name.toLowerCase().includes('female') || v.name.toLowerCase().includes('samantha') || v.name.toLowerCase().includes('karen'));
        if (female) {
          utterance.voice = female;
        }
        utterance.lang = 'en-US';
        speechSynthesis.speak(utterance);
      });

      gapi.load('client', loadClient);
    </script>
  </body>
</html>
